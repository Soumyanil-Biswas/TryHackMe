
Task 1  Introduction
---------------------


Task 2  Deploy!
---------------

Important portions will be noted here, else please visit the [room](https://tryhackme.com/room/rppsempire)

Nmap scan:
```
$ nmap $IP -sV -A -vv

		X --- snip --- X

PORT      STATE SERVICE            REASON  VERSION
135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       syn-ack Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server? syn-ack
| ssl-cert: Subject: commonName=Jon-PC
| Issuer: commonName=Jon-PC
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2021-07-21T05:28:31
| Not valid after:  2022-01-20T05:28:31
| MD5:   bdce f10f 6992 43f8 e0ce 0d6a d420 f64f
| SHA-1: b201 c395 6dc4 0275 3722 8775 7afa b192 c3df 1b26
| -----BEGIN CERTIFICATE-----
| MIIC0DCCAbigAwIBAgIQK5HIYiQ2gr9APctJqgvBwDANBgkqhkiG9w0BAQUFADAR
| MQ8wDQYDVQQDEwZKb24tUEMwHhcNMjEwNzIxMDUyODMxWhcNMjIwMTIwMDUyODMx
| WjARMQ8wDQYDVQQDEwZKb24tUEMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
| AoIBAQC0Hoy9l77ta7D6btkzk/9ehAK1S6U7zS029myXGKLnXLVYdnVUPt6M5kxq
| x8F3HiwLsdjVsgrSs6UpV7225I3CN58CL5/B0cAAPsSfMorG+q4bgE2omQpxVET+
| I+Z1Xy3RcMzj1OPxuzAmbjSRLAh8sl/VrSlDVPlU62jGAE/FLf9BvOIvEVz7/yAU
| HE34j5Of8oRzK0+YhdKEssF8SeGYUoswdGtM3h8gOJ3SG4EUr8xz/fyYmLD3zelV
| 8dQaRXBdsBHh4FXR8F4IMjp7J+UXZA0605tNHzQxXNQGRFsJSWkMTrGqgBJMHnZE
| 8U5h+2nW3fGqdGtgLn1RPMI4zgOLAgMBAAGjJDAiMBMGA1UdJQQMMAoGCCsGAQUF
| BwMBMAsGA1UdDwQEAwIEMDANBgkqhkiG9w0BAQUFAAOCAQEAl3YO+xBUZ+O7VLKf
| 6OI8Mk+oEbuC1fVAV7pLmqKMFYmL1jIzGswBs04Tj3l1lBFVvOkCaHFRdZXlOwJW
| 2xL5QMzcbRCGU9GnFlvNhvME289Gh0ZfWbEQ0LTBpoqhG+sPZgT2RAU6Gxx7jkRb
| CPRiObiCSCXqqpt2MaSSIpZf8JdxaE/sRxvZxI0HTe2KP7J3RRRavkJPSXqRMOet
| dAdEhbPgBU+ahON1HYNqxKmmuYOHVg8wEzmNNV6VZbWwO2VZPmu0vmAUr5sqBBGo
| TeIaXY20GcWz7wVqhvBB2KVXct6VS4UE0tY2UuEjGClwnC80sRkJbaZCip0VJiDr
| BKZdFA==
|_-----END CERTIFICATE-----
|_ssl-date: 2021-07-22T06:33:07+00:00; 0s from scanner time.
49152/tcp open  msrpc              syn-ack Microsoft Windows RPC
49153/tcp open  msrpc              syn-ack Microsoft Windows RPC
49154/tcp open  msrpc              syn-ack Microsoft Windows RPC
49158/tcp open  msrpc              syn-ack Microsoft Windows RPC
49160/tcp open  msrpc              syn-ack Microsoft Windows RPC
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1h15m00s, deviation: 2h30m00s, median: 0s
| nbstat: NetBIOS name: JON-PC, NetBIOS user: <unknown>, NetBIOS MAC: 02:a1:d4:3e:7d:37 (unknown)
| Names:
|   JON-PC<00>           Flags: <unique><active>
|   WORKGROUP<00>        Flags: <group><active>
|   JON-PC<20>           Flags: <unique><active>
|   WORKGROUP<1e>        Flags: <group><active>
|   WORKGROUP<1d>        Flags: <unique><active>
|   \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
| Statistics:
|   02 a1 d4 3e 7d 37 00 00 00 00 00 00 00 00 00 00 00
|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
|_  00 00 00 00 00 00 00 00 00 00 00 00 00 00
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 57534/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 53541/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 63036/udp): CLEAN (Failed to receive data)
|   Check 4 (port 60565/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: Jon-PC
|   NetBIOS computer name: JON-PC\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2021-07-22T01:33:01-05:00
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-07-22T06:33:01
|_  start_date: 2021-07-22T05:28:30

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:03
Completed NSE at 12:03, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:03
Completed NSE at 12:03, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:03
Completed NSE at 12:03, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ 
```

From the above output, we can see this:
```
smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
```
Here,`message_signing: disabled (dangerous, but default)`, this ***dangerous*** word made me suspicious. 

I  made a ***smb_version_scan***:
```
$ nmap --script smb-protocols -p445,139 $IP -sV -A -vv

			x --- snip --- x

PORT    STATE SERVICE      REASON  VERSION
139/tcp open  netbios-ssn  syn-ack Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-protocols: 
|   dialects: 
|     NT LM 0.12 (SMBv1) [dangerous, but default]
|     2.02
|_    2.10

			x --- snip --- x
```
#### OR

```
$ nmap  [machine_ip] -A -T4 --script vuln


			x --- snip --- x

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/

```

We can see here directly: `CVE-2017-0143` => ***SMBv1 servers ms17-010***

Here, we can see the _version_ of ***SMB*** is ***1*** :arrow_right: ***Eternalblue***


So, used **eternalblue** to get a _`nt-authority privleged shell`_.


Task3:  Installation
----------------------

**StarKiller** is basically the _GUI Front End_ and  **Empire** is the _CLI Back End_.


#### NOTE:
This room itself will showcase ***Starkiller*** (~~***Not Empire***~~) but all functionalities are the same.

```
$ sudo ./powershell-empire server
```

Task4:  Menu Overview
-----------------------

Read from: [room](https://tryhackme.com/room/rppsempire)


Task5:  Listeners
------------------

See from : [room](https://tryhackme.com/room/rppsempire)


Task6: Stagers
---------------

See from : [room](https://tryhackme.com/room/rppsempire)


Task7:  Agents
---------------

See from : [room](https://tryhackme.com/room/rppsempire)


Task8:  Modules
----------------

See from : [room](https://tryhackme.com/room/rppsempire)

Task9:  Plugins
-----------------

See from : [room](https://tryhackme.com/room/rppsempire)


